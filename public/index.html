<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√≥picos de Ci√™ncia da Computa√ß√£o</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 600px;
            width: 100%;
            min-height: 500px;
            position: relative;
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .rules {
            text-align: left;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .rules h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .rules ul {
            padding-left: 20px;
        }

        .rules li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .topic-card {
            background: #fff;
            border: 3px solid #667eea;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .topic-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .topic-card.pulsing {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% {
                background-color: #fff;
                border-color: #667eea;
            }
            50% {
                background-color: #f0f7ff;
                border-color: #4a90e2;
            }
            100% {
                background-color: #fff;
                border-color: #667eea;
            }
        }

        .topic-card.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #4a90e2;
        }

        .topic-card.correct {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border-color: #4CAF50;
        }

        .topic-card.incorrect {
            background: linear-gradient(135deg, #f44336, #da190b);
            color: white;
            border-color: #f44336;
        }

        .timer {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 10px 15px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2em;
        }

        .timer.warning {
            background: #ff6b6b;
            animation: blink 0.5s infinite;
        }

        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .progress {
            background: #e0e0e0;
            height: 8px;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .results {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .results h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .score {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
        }

        .score.excellent {
            color: #4CAF50;
        }

        .score.good {
            color: #ff9800;
        }

        .score.needs-improvement {
            color: #f44336;
        }

        .game-info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 0.9em;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
                margin: 10px;
            }

            h1 {
                font-size: 2em;
            }

            .btn {
                padding: 12px 24px;
                font-size: 1em;
            }

            .timer {
                position: relative;
                top: 0;
                right: 0;
                margin: 10px 0;
            }

            .game-info {
                position: relative;
                top: 0;
                left: 0;
                margin: 10px 0;
            }
        }

        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }

    .topic-card.pulsing {
        animation: pulse 1s infinite, float 2.5s ease-in-out infinite;
    }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tela Inicial -->
        <div class="screen active" id="home-screen">
            <h1>üéØ T√≥picos de Ci√™ncia da Computa√ß√£o</h1>
            <p style="font-size: 1.2em; margin-bottom: 30px;">
                Teste seus conhecimentos sobre os t√≥picos que interessam diretamente √† Ci√™ncia da Computa√ß√£o!
            </p>
            <button class="btn" onclick="startGame()">üöÄ Iniciar Jogo</button>
        </div>

        <!-- Tela de Regras -->
        <div class="screen" id="rules-screen">
            <h1>üìã Regras do Jogo</h1>
            <div class="rules">
                <h3>Como Jogar:</h3>
                <ul>
                    <li>Clique APENAS nos t√≥picos pelos quais a Ci√™ncia da Computa√ß√£o se interessa diretamente</li>
                    <li>Cada t√≥pico aparece por 10 segundos - se n√£o clicar, passa para o pr√≥ximo</li>
                    <li>Primeiro voc√™ ter√° uma rodada de treino com "Engenharia de Software"</li>
                    <li>Depois come√ßar√° o jogo real com v√°rios t√≥picos misturados</li>
                    <li>Ao final, ver√° sua porcentagem de acertos</li>
                </ul>
                <h3>Pontua√ß√£o:</h3>
                <ul>
                    <li>‚úÖ Acerto: Selecionar um t√≥pico de interesse da CC</li>
                    <li>‚úÖ Acerto: N√ÉO selecionar um t√≥pico que n√£o √© de interesse</li>
                    <li>‚ùå Erro: Selecionar um t√≥pico que N√ÉO √© de interesse</li>
                    <li>‚ùå Erro: N√ÉO selecionar um t√≥pico que √â de interesse</li>
                </ul>
            </div>
            <button class="btn" onclick="showHome()">‚Üê Voltar</button>
            <button class="btn" onclick="startGame()">üöÄ Iniciar Jogo</button>
        </div>

        <!-- Tela de Treino -->
        <div class="screen" id="training-screen">
            <h1>üéì Treino</h1>
            <div class="game-info">
                <strong>Modo:</strong> Treino
            </div>
            <div class="timer" id="training-timer">10</div>
            <p style="margin-bottom: 20px;">
                Esta √© uma rodada de treino. Clique no t√≥pico se ele for de interesse direto da Ci√™ncia da Computa√ß√£o:
            </p>
            <div class="topic-card pulsing" id="training-topic" onclick="selectTrainingTopic()">
                <h3>Engenharia de software</h3>
            </div>
            <p style="margin-top: 20px; color: #666;">
                Dica: Engenharia de software √â um t√≥pico de interesse direto da Ci√™ncia da Computa√ß√£o!
            </p>
        </div>

        <!-- Tela do Jogo -->
        <div class="screen" id="game-screen">
            <h1>üéÆ Jogo</h1>
            <div class="game-info">
                <strong>T√≥pico:</strong> <span id="current-topic-number">1</span>/<span id="total-topics">0</span>
            </div>
            <div class="timer" id="game-timer">10</div>
            <div class="progress">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <div class="topic-card pulsing" id="game-topic" onclick="selectGameTopic()">
                <h3 id="current-topic-text"></h3>
            </div>
            <p style="margin-top: 20px; color: #666;">
                Clique no t√≥pico se ele for de interesse direto da Ci√™ncia da Computa√ß√£o
            </p>
        </div>

        <!-- Tela de Resultados -->
        <div class="screen" id="results-screen">
            <h1>üìä Resultados</h1>
            <div class="results">
                <div class="score" id="final-score">0%</div>
                <div id="score-details"></div>
                <div id="performance-message"></div>
            </div>
            <button class="btn" onclick="showHome()">üè† In√≠cio</button>
            <button class="btn" onclick="startGame()">üîÑ Jogar Novamente</button>
        </div>
    </div>

    <script>
        // T√≥picos de interesse da Ci√™ncia da Computa√ß√£o
        const csTopics = [
        "Abordagens curriculares envolvendo etnicidade, g√™nero, direitos humanos e inclus√£o",
        "Anal√≠ticas de aprendizagem (learning analytics) em computa√ß√£o",
        "Aspectos demogr√°ficos, sociais e econ√¥micos de cursos de computa√ß√£o",
        "Aspectos raciais/√©tnicos na educa√ß√£o em computa√ß√£o",
        "Aspectos √©ticos na educa√ß√£o em computa√ß√£o",
        "Avalia√ß√£o automatizada de tarefas de programa√ß√£o",
        "Avalia√ß√£o da aprendizagem em computa√ß√£o",
        "Avalia√ß√£o de pensamento computacional",
        "Computa√ß√£o desplugada",
        "Computa√ß√£o na educa√ß√£o infantil",
        "Computa√ß√£o na educa√ß√£o profissional",
        "Computa√ß√£o no ensino fundamental",
        "Computa√ß√£o no ensino m√©dio",
        "Comunidades discentes em cursos de computa√ß√£o",
        "Concep√ß√µes e organiza√ß√µes curriculares em computa√ß√£o",
        "Curriculariza√ß√£o da pesquisa e da extens√£o em computa√ß√£o",
        "Did√°tica de computa√ß√£o",
        "Diversidade em cursos de computa√ß√£o",
        "Educa√ß√£o continuada em computa√ß√£o",
        "Educa√ß√£o corporativa em computa√ß√£o",
        "Educa√ß√£o de jovens e adultos em computa√ß√£o",
        "Educa√ß√£o em computa√ß√£o aberta e livre (e.g. REA, MOOC)",
        "Educa√ß√£o em computa√ß√£o atrav√©s do uso de imagens, √°udio e v√≠deo",
        "Educa√ß√£o em computa√ß√£o em espa√ßos n√£o-formais",
        "Ensino e/ou aprendizagem de computa√ß√£o",
        "Estrat√©gias de ensino e/ou aprendizagem de computa√ß√£o",
        "Estudos de g√™nero na educa√ß√£o em computa√ß√£o",
        "Estudos secund√°rios: revis√µes sistem√°ticas e mapeamentos sistem√°ticos",
        "Est√°gio supervisionado na forma√ß√£o de professores de computa√ß√£o",
        "Evas√£o e reten√ß√£o em cursos e disciplinas de computa√ß√£o",
        "Fatores psicol√≥gicos e emocionais em educa√ß√£o em computa√ß√£o",
        "Feedback de tarefas de programa√ß√£o",
        "Forma√ß√£o cient√≠fica em cursos de computa√ß√£o",
        "Forma√ß√£o continuada de professores em computa√ß√£o",
        "Forma√ß√£o inicial de professores em computa√ß√£o",
        "Forma√ß√£o na p√≥s-gradua√ß√£o em computa√ß√£o",
        "Habilidades t√©cnicas (hard skills) e n√£o-t√©cnicas (soft skills) em computa√ß√£o",
        "Hardware na educa√ß√£o em computa√ß√£o",
        "Implanta√ß√£o e avalia√ß√£o continuada de curr√≠culos, programas e cursos de computa√ß√£o",
        "Inclus√£o e acessibilidade na educa√ß√£o em computa√ß√£o",
        "Integra√ß√£o dos conte√∫dos exigidos por legisla√ß√£o em curr√≠culos de computa√ß√£o",
        "Intelig√™ncia artificial e aprendizado de m√°quina na educa√ß√£o em computa√ß√£o",
        "Intera√ß√£o entre academia e ind√∫stria de TI",
        "Jogos e gamifica√ß√£o na educa√ß√£o em computa√ß√£o",
        "Linguagens visuais e textuais para aprendizagem de programa√ß√£o",
        "Materiais did√°ticos de computa√ß√£o",
        "Mentoria na gradua√ß√£o e p√≥s-gradua√ß√£o em computa√ß√£o",
        "Metacogni√ß√£o na educa√ß√£o em computa√ß√£o",
        "Metodologias ativas no ensino e/ou aprendizagem de computa√ß√£o",
        "Minera√ß√£o de dados educacionais em computa√ß√£o",
        "Modelos de monitoria e apoio discente em disciplinas de gradua√ß√£o",
        "M√©todos e estrat√©gias para concep√ß√£o de curr√≠culos, programas e cursos de computa√ß√£o",
        "Pensamento computacional",
        "Programa√ß√£o na educa√ß√£o superior",
        "Pr√°tica de ensino de computa√ß√£o na forma√ß√£o de professores",
        "Psicologia da programa√ß√£o",
        "Realidade virtual e aumentada na educa√ß√£o em computa√ß√£o",
        "Recursos de apoio √† educa√ß√£o em computa√ß√£o",
        "Redes e m√≠dias sociais em educa√ß√£o em computa√ß√£o",
        "Rob√≥tica na educa√ß√£o em computa√ß√£o",
        "Saberes docentes na computa√ß√£o",
        "Teorias educacionais e psicol√≥gicas aplicadas √† educa√ß√£o em computa√ß√£o"
        ];


        // T√≥picos que N√ÉO s√£o de interesse direto da Ci√™ncia da Computa√ß√£o
        const nonCSTopics = [
            "Marketing Digital",
            "Teoria dos jogos",
            "Sistemas el√©tricos",
        ];

        // Vari√°veis do jogo
        let currentTopicIndex = 0;
        let gameTopics = [];
        let timer = 10;
        let timerInterval;
        let gameResponses = [];
        let startTime;
        let trainingCompleted = false;
        let score = 0;

        // Controle de telas
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function showHome() {
            showScreen('home-screen');
        }

        function showRules() {
            showScreen('rules-screen');
        }

        // Fun√ß√£o para iniciar o jogo
        function startGame() {
        if (!trainingCompleted) {
            showRulesBeforeTraining();
        } else {
            startMainGame();
            }
        }
        function showRulesBeforeTraining() {
    showScreen('rules-screen');

    // Substitui os bot√µes padr√£o por um √∫nico bot√£o de continua√ß√£o
    const rulesScreen = document.getElementById('rules-screen');
    rulesScreen.querySelectorAll('.btn').forEach(btn => btn.style.display = 'none');

    const continueBtn = document.createElement('button');
    continueBtn.className = 'btn';
    continueBtn.textContent = '‚úÖ Entendi, vamos come√ßar!';
    continueBtn.onclick = () => {
        rulesScreen.querySelectorAll('.btn').forEach(btn => btn.style.display = '');
        continueBtn.remove();
        startTraining();
    };
    rulesScreen.appendChild(continueBtn);
}


        // Treino
        function startTraining() {
            showScreen('training-screen');
            startTimer('training-timer', () => {
                // Se n√£o clicou, considera erro
                gameResponses.push({
                    topic: "Engenharia de software",
                    isCSRelated: true,
                    selected: false,
                    correct: false,
                    timestamp: new Date().toISOString()
                });
                alert('Voc√™ deveria ter clicado! Engenharia de software √â um t√≥pico de interesse da Ci√™ncia da Computa√ß√£o. Vamos tentar novamente!');
                startTraining();
            });
        }

        function selectTrainingTopic() {
            clearInterval(timerInterval);
            document.getElementById('training-topic').classList.add('correct');
            
            gameResponses.push({
                topic: "Engenharia de software",
                isCSRelated: true,
                selected: true,
                correct: true,
                timestamp: new Date().toISOString()
            });

            setTimeout(() => {
                alert('Muito bem! Engenharia de software √â um t√≥pico de interesse direto da Ci√™ncia da Computa√ß√£o!');
                trainingCompleted = true;
                startMainGame();
            }, 1000);
        }

        // Jogo principal
        function startMainGame() {
            score = 0;
            // Mistura todos os t√≥picos
            gameTopics = [...csTopics, ...nonCSTopics];
            shuffleArray(gameTopics);
            
            currentTopicIndex = 0;
            gameResponses = [];
            startTime = new Date();
            
            document.getElementById('total-topics').textContent = gameTopics.length;
            showScreen('game-screen');
            showNextTopic();
        }

        function showNextTopic() {
    if (currentTopicIndex >= gameTopics.length) {
        showResults();
        return;
    }

    const topic = gameTopics[currentTopicIndex];
    document.getElementById('current-topic-text').textContent = topic;
    document.getElementById('current-topic-number').textContent = currentTopicIndex + 1;

    // Atualiza barra de progresso
    const progress = ((currentTopicIndex + 1) / gameTopics.length) * 100;
    document.getElementById('progress-bar').style.width = progress + '%';

    // Reset do card
    const topicCard = document.getElementById('game-topic');
    topicCard.classList.remove('selected', 'correct', 'incorrect');
    topicCard.classList.add('pulsing');

    // Aguarda 100ms para garantir que o DOM foi atualizado antes de iniciar o cron√¥metro
    setTimeout(() => {
        startTimer('game-timer', () => {
            const isCSRelated = csTopics.includes(topic);
            const correct = !isCSRelated;
            score += correct ? 1 : -1;

            gameResponses.push({
                topic: topic,
                isCSRelated: isCSRelated,
                selected: false,
                correct: correct,
                timestamp: new Date().toISOString(),
                timeSpent: 10
            });

            currentTopicIndex++;
            showNextTopic();
        });
    }, 100);
}


        function selectGameTopic() {
    clearInterval(timerInterval);

    const topic = gameTopics[currentTopicIndex];
    const isCSRelated = csTopics.includes(topic);
    const correct = isCSRelated;
    const timeSpent = 10 - timer;

    // Pontua√ß√£o: +1 para acerto, -1 para erro
    score += correct ? 1 : -1;

    gameResponses.push({
        topic: topic,
        isCSRelated: isCSRelated,
        selected: true,
        correct: correct,
        timestamp: new Date().toISOString(),
        timeSpent: timeSpent
    });

    const topicCard = document.getElementById('game-topic');
    topicCard.classList.remove('pulsing');
    topicCard.classList.add('selected');

    // N√ÉO adicionar classe de correto ou incorreto ‚Äî mantemos apenas o azul
    setTimeout(() => {
        currentTopicIndex++;
        showNextTopic();
    }, 1000);
}


        // Timer
        function startTimer(timerId, onComplete) {
            timer = 10;
            const timerElement = document.getElementById(timerId);
            
            timerInterval = setInterval(() => {
                timer--;
                timerElement.textContent = timer;
                
                if (timer <= 3) {
                    timerElement.classList.add('warning');
                } else {
                    timerElement.classList.remove('warning');
                }
                
                if (timer <= 0) {
                    clearInterval(timerInterval);
                    timerElement.classList.remove('warning');
                    onComplete();
                }
            }, 1000);
        }

        // Resultados
        function showResults() {
    const totalQuestions = gameResponses.length;
    const correctAnswers = gameResponses.filter(r => r.correct).length;
    const percentage = Math.round((correctAnswers / totalQuestions) * 100);
    
    document.getElementById('final-score').textContent = percentage + '%';

    const scoreElement = document.getElementById('final-score');
    if (percentage >= 80) {
        scoreElement.classList.add('excellent');
        document.getElementById('performance-message').innerHTML = 
            '<h3>üéâ Excelente!</h3><p>Voc√™ demonstra um √≥timo conhecimento sobre os t√≥picos da Ci√™ncia da Computa√ß√£o!</p>';
    } else if (percentage >= 60) {
        scoreElement.classList.add('good');
        document.getElementById('performance-message').innerHTML = 
            '<h3>üëç Bom!</h3><p>Voc√™ tem um bom conhecimento, mas ainda pode melhorar!</p>';
    } else {
        scoreElement.classList.add('needs-improvement');
        document.getElementById('performance-message').innerHTML = 
            '<h3>üìö Precisa melhorar</h3><p>Que tal estudar mais sobre os t√≥picos da Ci√™ncia da Computa√ß√£o?</p>';
    }

    const details = `
        <p><strong>Acertos:</strong> ${correctAnswers}/${totalQuestions}</p>
        <p><strong>Tempo total:</strong> ${Math.round((new Date() - startTime) / 1000)}s</p>
    `;
    
    document.getElementById('score-details').innerHTML = details;

    downloadResults();

    // Prote√ß√£o: adiciona um pequeno atraso antes de mostrar a tela final
    setTimeout(() => {
        showScreen('results-screen');
    }, 100); // ou at√© 300ms se quiser evitar totalmente duplos cliques
}


        // Download dos resultados
        function downloadResults() {
            const payload = {
                timestamp: new Date().toISOString(),
                responses: gameResponses
            };

            fetch('http://localhost:3000/registrar', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            })
            .then(res => res.text())
            .then(msg => console.log(msg))
            .catch(err => console.error('Erro ao registrar:', err));
}


        function convertToCSV(results) {
            const headers = ['T√≥pico', '√â de interesse da CC', 'Foi selecionado', 'Resposta correta', 'Tempo gasto (s)', 'Timestamp'];
            const rows = results.responses.map(r => [
                `"${r.topic}"`,
                r.isCSRelated ? 'Sim' : 'N√£o',
                r.selected ? 'Sim' : 'N√£o',
                r.correct ? 'Sim' : 'N√£o',
                r.timeSpent || 10,
                r.timestamp
            ]);
            
            return [headers.join(','), ...rows.map(row => row.join(','))].join('\n');
        }

        function downloadCSV(csv, filename) {
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Fun√ß√£o auxiliar para embaralhar array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
    </script>
</body>
</html>